--- net/minecraft/world/level/levelgen/placement/FeatureDecorator.java
+++ net/minecraft/world/level/levelgen/placement/FeatureDecorator.java
@@ -1,99 +1,146 @@
 package net.minecraft.world.level.levelgen.placement;
 
-import com.mojang.datafixers.Dynamic;
+import com.mojang.serialization.Codec;
 import java.util.Random;
-import java.util.concurrent.atomic.AtomicBoolean;
-import java.util.function.Function;
 import java.util.stream.Stream;
 import net.minecraft.core.BlockPos;
 import net.minecraft.core.Registry;
 import net.minecraft.world.level.LevelAccessor;
+import net.minecraft.world.level.StructureFeatureManager;
+import net.minecraft.world.level.WorldGenLevel;
 import net.minecraft.world.level.chunk.ChunkGenerator;
-import net.minecraft.world.level.levelgen.ChunkGeneratorSettings;
 import net.minecraft.world.level.levelgen.feature.ConfiguredFeature;
 import net.minecraft.world.level.levelgen.feature.Feature;
 import net.minecraft.world.level.levelgen.feature.configurations.ChanceRangeDecoratorConfiguration;
 import net.minecraft.world.level.levelgen.feature.configurations.CountRangeDecoratorConfiguration;
 import net.minecraft.world.level.levelgen.feature.configurations.DecoratorConfiguration;
 import net.minecraft.world.level.levelgen.feature.configurations.FeatureConfiguration;
 import net.minecraft.world.level.levelgen.feature.configurations.NoiseDependantDecoratorConfiguration;
 import net.minecraft.world.level.levelgen.feature.configurations.NoneDecoratorConfiguration;
 import net.minecraft.world.level.levelgen.placement.nether.ChanceRangeDecorator;
 import net.minecraft.world.level.levelgen.placement.nether.CountRangeDecorator;
-import net.minecraft.world.level.levelgen.placement.nether.HellFireDecorator;
+import net.minecraft.world.level.levelgen.placement.nether.FireDecorator;
 import net.minecraft.world.level.levelgen.placement.nether.LightGemChanceDecorator;
 import net.minecraft.world.level.levelgen.placement.nether.MagmaDecorator;
 import net.minecraft.world.level.levelgen.placement.nether.RandomCountRangeDecorator;
+import org.apache.commons.lang3.mutable.MutableBoolean;
 
 public abstract class FeatureDecorator<DC extends DecoratorConfiguration> {
-   public static final FeatureDecorator<NoneDecoratorConfiguration> NOPE = register("nope", new NopePlacementDecorator(NoneDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_HEIGHTMAP = register("count_heightmap", new CountHeightmapDecorator(FrequencyDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_TOP_SOLID = register("count_top_solid", new CountTopSolidDecorator(FrequencyDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_HEIGHTMAP_32 = register("count_heightmap_32", new CountHeightmap32Decorator(FrequencyDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_HEIGHTMAP_DOUBLE = register("count_heightmap_double", new CountHeighmapDoubleDecorator(FrequencyDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_HEIGHT_64 = register("count_height_64", new CountHeight64Decorator(FrequencyDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<NoiseDependantDecoratorConfiguration> NOISE_HEIGHTMAP_32 = register("noise_heightmap_32", new NoiseHeightmap32Decorator(NoiseDependantDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<NoiseDependantDecoratorConfiguration> NOISE_HEIGHTMAP_DOUBLE = register("noise_heightmap_double", new NoiseHeightmapDoubleDecorator(NoiseDependantDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<ChanceDecoratorConfiguration> CHANCE_HEIGHTMAP = register("chance_heightmap", new ChanceHeightmapDecorator(ChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<ChanceDecoratorConfiguration> CHANCE_HEIGHTMAP_DOUBLE = register("chance_heightmap_double", new ChanceHeightmapDoubleDecorator(ChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<ChanceDecoratorConfiguration> CHANCE_PASSTHROUGH = register("chance_passthrough", new ChancePassthroughDecorator(ChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<ChanceDecoratorConfiguration> CHANCE_TOP_SOLID_HEIGHTMAP = register("chance_top_solid_heightmap", new ChanceTopSolidHeightmapDecorator(ChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyWithExtraChanceDecoratorConfiguration> COUNT_EXTRA_HEIGHTMAP = register("count_extra_heightmap", new CountWithExtraChanceHeightmapDecorator(FrequencyWithExtraChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<CountRangeDecoratorConfiguration> COUNT_RANGE = register("count_range", new CountRangeDecorator(CountRangeDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<CountRangeDecoratorConfiguration> COUNT_BIASED_RANGE = register("count_biased_range", new CountBiasedRangeDecorator(CountRangeDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<CountRangeDecoratorConfiguration> COUNT_VERY_BIASED_RANGE = register("count_very_biased_range", new CountVeryBiasedRangeDecorator(CountRangeDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<CountRangeDecoratorConfiguration> RANDOM_COUNT_RANGE = register("random_count_range", new RandomCountRangeDecorator(CountRangeDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<ChanceRangeDecoratorConfiguration> CHANCE_RANGE = register("chance_range", new ChanceRangeDecorator(ChanceRangeDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyChanceDecoratorConfiguration> COUNT_CHANCE_HEIGHTMAP = register("count_chance_heightmap", new CountChanceHeightmapDecorator(FrequencyChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyChanceDecoratorConfiguration> COUNT_CHANCE_HEIGHTMAP_DOUBLE = register("count_chance_heightmap_double", new CountChanceHeightmapDoubleDecorator(FrequencyChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<DepthAverageConfigation> COUNT_DEPTH_AVERAGE = register("count_depth_average", new CountDepthAverageDecorator(DepthAverageConfigation::deserialize));
-   public static final FeatureDecorator<NoneDecoratorConfiguration> TOP_SOLID_HEIGHTMAP = register("top_solid_heightmap", new TopSolidHeightMapDecorator(NoneDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<RangeDecoratorConfiguration> TOP_SOLID_HEIGHTMAP_RANGE = register("top_solid_heightmap_range", new TopSolidHeightMapRangeDecorator(RangeDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<NoiseCountFactorDecoratorConfiguration> TOP_SOLID_HEIGHTMAP_NOISE_BIASED = register("top_solid_heightmap_noise_biased", new TopSolidHeightMapNoiseBasedDecorator(NoiseCountFactorDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<CarvingMaskDecoratorConfiguration> CARVING_MASK = register("carving_mask", new CarvingMaskDecorator(CarvingMaskDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyDecoratorConfiguration> FOREST_ROCK = register("forest_rock", new ForestRockPlacementDecorator(FrequencyDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyDecoratorConfiguration> HELL_FIRE = register("hell_fire", new HellFireDecorator(FrequencyDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyDecoratorConfiguration> MAGMA = register("magma", new MagmaDecorator(FrequencyDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<NoneDecoratorConfiguration> EMERALD_ORE = register("emerald_ore", new EmeraldPlacementDecorator(NoneDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<ChanceDecoratorConfiguration> LAVA_LAKE = register("lava_lake", new LakeLavaPlacementDecorator(ChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<ChanceDecoratorConfiguration> WATER_LAKE = register("water_lake", new LakeWaterPlacementDecorator(ChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<ChanceDecoratorConfiguration> DUNGEONS = register("dungeons", new MonsterRoomPlacementDecorator(ChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<NoneDecoratorConfiguration> DARK_OAK_TREE = register("dark_oak_tree", new DarkOakTreePlacementDecorator(NoneDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<ChanceDecoratorConfiguration> ICEBERG = register("iceberg", new IcebergPlacementDecorator(ChanceDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<FrequencyDecoratorConfiguration> LIGHT_GEM_CHANCE = register("light_gem_chance", new LightGemChanceDecorator(FrequencyDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<NoneDecoratorConfiguration> END_ISLAND = register("end_island", new EndIslandPlacementDecorator(NoneDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<NoneDecoratorConfiguration> CHORUS_PLANT = register("chorus_plant", new ChorusPlantPlacementDecorator(NoneDecoratorConfiguration::deserialize));
-   public static final FeatureDecorator<NoneDecoratorConfiguration> END_GATEWAY = register("end_gateway", new EndGatewayPlacementDecorator(NoneDecoratorConfiguration::deserialize));
-   private final Function<Dynamic<?>, ? extends DC> configurationFactory;
+   public static final FeatureDecorator<NoneDecoratorConfiguration> NOPE;
+   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_HEIGHTMAP;
+   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_TOP_SOLID;
+   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_HEIGHTMAP_32;
+   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_HEIGHTMAP_DOUBLE;
+   public static final FeatureDecorator<FrequencyDecoratorConfiguration> COUNT_HEIGHT_64;
+   public static final FeatureDecorator<NoiseDependantDecoratorConfiguration> NOISE_HEIGHTMAP_32;
+   public static final FeatureDecorator<NoiseDependantDecoratorConfiguration> NOISE_HEIGHTMAP_DOUBLE;
+   public static final FeatureDecorator<ChanceDecoratorConfiguration> CHANCE_HEIGHTMAP;
+   public static final FeatureDecorator<ChanceDecoratorConfiguration> CHANCE_HEIGHTMAP_DOUBLE;
+   public static final FeatureDecorator<ChanceDecoratorConfiguration> CHANCE_PASSTHROUGH;
+   public static final FeatureDecorator<ChanceDecoratorConfiguration> CHANCE_TOP_SOLID_HEIGHTMAP;
+   public static final FeatureDecorator<FrequencyWithExtraChanceDecoratorConfiguration> COUNT_EXTRA_HEIGHTMAP;
+   public static final FeatureDecorator<CountRangeDecoratorConfiguration> COUNT_RANGE;
+   public static final FeatureDecorator<CountRangeDecoratorConfiguration> COUNT_BIASED_RANGE;
+   public static final FeatureDecorator<CountRangeDecoratorConfiguration> COUNT_VERY_BIASED_RANGE;
+   public static final FeatureDecorator<CountRangeDecoratorConfiguration> RANDOM_COUNT_RANGE;
+   public static final FeatureDecorator<ChanceRangeDecoratorConfiguration> CHANCE_RANGE;
+   public static final FeatureDecorator<FrequencyChanceDecoratorConfiguration> COUNT_CHANCE_HEIGHTMAP;
+   public static final FeatureDecorator<FrequencyChanceDecoratorConfiguration> COUNT_CHANCE_HEIGHTMAP_DOUBLE;
+   public static final FeatureDecorator<DepthAverageConfigation> COUNT_DEPTH_AVERAGE;
+   public static final FeatureDecorator<NoneDecoratorConfiguration> TOP_SOLID_HEIGHTMAP;
+   public static final FeatureDecorator<RangeDecoratorConfiguration> TOP_SOLID_HEIGHTMAP_RANGE;
+   public static final FeatureDecorator<NoiseCountFactorDecoratorConfiguration> TOP_SOLID_HEIGHTMAP_NOISE_BIASED;
+   public static final FeatureDecorator<CarvingMaskDecoratorConfiguration> CARVING_MASK;
+   public static final FeatureDecorator<FrequencyDecoratorConfiguration> FOREST_ROCK;
+   public static final FeatureDecorator<FrequencyDecoratorConfiguration> FIRE;
+   public static final FeatureDecorator<FrequencyDecoratorConfiguration> MAGMA;
+   public static final FeatureDecorator<NoneDecoratorConfiguration> EMERALD_ORE;
+   public static final FeatureDecorator<ChanceDecoratorConfiguration> LAVA_LAKE;
+   public static final FeatureDecorator<ChanceDecoratorConfiguration> WATER_LAKE;
+   public static final FeatureDecorator<ChanceDecoratorConfiguration> DUNGEONS;
+   public static final FeatureDecorator<NoneDecoratorConfiguration> DARK_OAK_TREE;
+   public static final FeatureDecorator<ChanceDecoratorConfiguration> ICEBERG;
+   public static final FeatureDecorator<FrequencyDecoratorConfiguration> LIGHT_GEM_CHANCE;
+   public static final FeatureDecorator<NoneDecoratorConfiguration> END_ISLAND;
+   public static final FeatureDecorator<NoneDecoratorConfiguration> CHORUS_PLANT;
+   public static final FeatureDecorator<NoneDecoratorConfiguration> END_GATEWAY;
+   private final Codec<ConfiguredDecorator<DC>> configuredCodec;
 
    private static <T extends DecoratorConfiguration, G extends FeatureDecorator<T>> G register(String var0, G var1) {
       return (FeatureDecorator)Registry.register(Registry.DECORATOR, (String)var0, var1);
    }
 
-   public FeatureDecorator(Function<Dynamic<?>, ? extends DC> var1) {
-      this.configurationFactory = var1;
+   public FeatureDecorator(Codec<DC> var1) {
+      this.configuredCodec = var1.fieldOf("config").xmap((var1x) -> {
+         return new ConfiguredDecorator(this, var1x);
+      }, (var0) -> {
+         return var0.config;
+      }).codec();
    }
 
-   public DC createSettings(Dynamic<?> var1) {
-      return (DecoratorConfiguration)this.configurationFactory.apply(var1);
-   }
-
    public ConfiguredDecorator<DC> configured(DC var1) {
       return new ConfiguredDecorator(this, var1);
    }
 
-   protected <FC extends FeatureConfiguration, F extends Feature<FC>> boolean placeFeature(LevelAccessor var1, ChunkGenerator<? extends ChunkGeneratorSettings> var2, Random var3, BlockPos var4, DC var5, ConfiguredFeature<FC, F> var6) {
-      AtomicBoolean var7 = new AtomicBoolean(false);
-      this.getPositions(var1, var2, var3, var5, var4).forEach((var5x) -> {
-         boolean var6x = var6.place(var1, var2, var3, var5x);
-         var7.set(var7.get() || var6x);
+   public Codec<ConfiguredDecorator<DC>> configuredCodec() {
+      return this.configuredCodec;
+   }
+
+   protected <FC extends FeatureConfiguration, F extends Feature<FC>> boolean placeFeature(WorldGenLevel var1, StructureFeatureManager var2, ChunkGenerator var3, Random var4, BlockPos var5, DC var6, ConfiguredFeature<FC, F> var7) {
+      MutableBoolean var8 = new MutableBoolean();
+      this.getPositions(var1, var3, var4, var6, var5).forEach((var6x) -> {
+         if (var7.place(var1, var2, var3, var4, var6x)) {
+            var8.setTrue();
+         }
+
       });
-      return var7.get();
+      return var8.isTrue();
    }
 
-   public abstract Stream<BlockPos> getPositions(LevelAccessor var1, ChunkGenerator<? extends ChunkGeneratorSettings> var2, Random var3, DC var4, BlockPos var5);
+   public abstract Stream<BlockPos> getPositions(LevelAccessor var1, ChunkGenerator var2, Random var3, DC var4, BlockPos var5);
 
    public String toString() {
       return this.getClass().getSimpleName() + "@" + Integer.toHexString(this.hashCode());
    }
+
+   static {
+      NOPE = register("nope", new NopePlacementDecorator(NoneDecoratorConfiguration.CODEC));
+      COUNT_HEIGHTMAP = register("count_heightmap", new CountHeightmapDecorator(FrequencyDecoratorConfiguration.CODEC));
+      COUNT_TOP_SOLID = register("count_top_solid", new CountTopSolidDecorator(FrequencyDecoratorConfiguration.CODEC));
+      COUNT_HEIGHTMAP_32 = register("count_heightmap_32", new CountHeightmap32Decorator(FrequencyDecoratorConfiguration.CODEC));
+      COUNT_HEIGHTMAP_DOUBLE = register("count_heightmap_double", new CountHeighmapDoubleDecorator(FrequencyDecoratorConfiguration.CODEC));
+      COUNT_HEIGHT_64 = register("count_height_64", new CountHeight64Decorator(FrequencyDecoratorConfiguration.CODEC));
+      NOISE_HEIGHTMAP_32 = register("noise_heightmap_32", new NoiseHeightmap32Decorator(NoiseDependantDecoratorConfiguration.CODEC));
+      NOISE_HEIGHTMAP_DOUBLE = register("noise_heightmap_double", new NoiseHeightmapDoubleDecorator(NoiseDependantDecoratorConfiguration.CODEC));
+      CHANCE_HEIGHTMAP = register("chance_heightmap", new ChanceHeightmapDecorator(ChanceDecoratorConfiguration.CODEC));
+      CHANCE_HEIGHTMAP_DOUBLE = register("chance_heightmap_double", new ChanceHeightmapDoubleDecorator(ChanceDecoratorConfiguration.CODEC));
+      CHANCE_PASSTHROUGH = register("chance_passthrough", new ChancePassthroughDecorator(ChanceDecoratorConfiguration.CODEC));
+      CHANCE_TOP_SOLID_HEIGHTMAP = register("chance_top_solid_heightmap", new ChanceTopSolidHeightmapDecorator(ChanceDecoratorConfiguration.CODEC));
+      COUNT_EXTRA_HEIGHTMAP = register("count_extra_heightmap", new CountWithExtraChanceHeightmapDecorator(FrequencyWithExtraChanceDecoratorConfiguration.CODEC));
+      COUNT_RANGE = register("count_range", new CountRangeDecorator(CountRangeDecoratorConfiguration.CODEC));
+      COUNT_BIASED_RANGE = register("count_biased_range", new CountBiasedRangeDecorator(CountRangeDecoratorConfiguration.CODEC));
+      COUNT_VERY_BIASED_RANGE = register("count_very_biased_range", new CountVeryBiasedRangeDecorator(CountRangeDecoratorConfiguration.CODEC));
+      RANDOM_COUNT_RANGE = register("random_count_range", new RandomCountRangeDecorator(CountRangeDecoratorConfiguration.CODEC));
+      CHANCE_RANGE = register("chance_range", new ChanceRangeDecorator(ChanceRangeDecoratorConfiguration.CODEC));
+      COUNT_CHANCE_HEIGHTMAP = register("count_chance_heightmap", new CountChanceHeightmapDecorator(FrequencyChanceDecoratorConfiguration.CODEC));
+      COUNT_CHANCE_HEIGHTMAP_DOUBLE = register("count_chance_heightmap_double", new CountChanceHeightmapDoubleDecorator(FrequencyChanceDecoratorConfiguration.CODEC));
+      COUNT_DEPTH_AVERAGE = register("count_depth_average", new CountDepthAverageDecorator(DepthAverageConfigation.CODEC));
+      TOP_SOLID_HEIGHTMAP = register("top_solid_heightmap", new TopSolidHeightMapDecorator(NoneDecoratorConfiguration.CODEC));
+      TOP_SOLID_HEIGHTMAP_RANGE = register("top_solid_heightmap_range", new TopSolidHeightMapRangeDecorator(RangeDecoratorConfiguration.CODEC));
+      TOP_SOLID_HEIGHTMAP_NOISE_BIASED = register("top_solid_heightmap_noise_biased", new TopSolidHeightMapNoiseBasedDecorator(NoiseCountFactorDecoratorConfiguration.CODEC));
+      CARVING_MASK = register("carving_mask", new CarvingMaskDecorator(CarvingMaskDecoratorConfiguration.CODEC));
+      FOREST_ROCK = register("forest_rock", new ForestRockPlacementDecorator(FrequencyDecoratorConfiguration.CODEC));
+      FIRE = register("fire", new FireDecorator(FrequencyDecoratorConfiguration.CODEC));
+      MAGMA = register("magma", new MagmaDecorator(FrequencyDecoratorConfiguration.CODEC));
+      EMERALD_ORE = register("emerald_ore", new EmeraldPlacementDecorator(NoneDecoratorConfiguration.CODEC));
+      LAVA_LAKE = register("lava_lake", new LakeLavaPlacementDecorator(ChanceDecoratorConfiguration.CODEC));
+      WATER_LAKE = register("water_lake", new LakeWaterPlacementDecorator(ChanceDecoratorConfiguration.CODEC));
+      DUNGEONS = register("dungeons", new MonsterRoomPlacementDecorator(ChanceDecoratorConfiguration.CODEC));
+      DARK_OAK_TREE = register("dark_oak_tree", new DarkOakTreePlacementDecorator(NoneDecoratorConfiguration.CODEC));
+      ICEBERG = register("iceberg", new IcebergPlacementDecorator(ChanceDecoratorConfiguration.CODEC));
+      LIGHT_GEM_CHANCE = register("light_gem_chance", new LightGemChanceDecorator(FrequencyDecoratorConfiguration.CODEC));
+      END_ISLAND = register("end_island", new EndIslandPlacementDecorator(NoneDecoratorConfiguration.CODEC));
+      CHORUS_PLANT = register("chorus_plant", new ChorusPlantPlacementDecorator(NoneDecoratorConfiguration.CODEC));
+      END_GATEWAY = register("end_gateway", new EndGatewayPlacementDecorator(NoneDecoratorConfiguration.CODEC));
+   }
 }
